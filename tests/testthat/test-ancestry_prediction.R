test_that("ancestry prediction", {
  outpath = tempdir()
  kin = read.csv(test_path("testdata", "Sample01c_uncond_major_Single_GEDmatchPROReport.txt"), header=T, sep="\t")
  exp_centroids = read.csv(test_path("testdata", "Sample01c_major_uncond_AncestrySNPsOnly_Superpopulations_centroids_Calculations.txt"), header=T, sep="\t")
  exp_pcaplot = glue("{outpath}/PCA_plots/Sample01c_major_uncond_AncestrySNPsOnly_superpop_3D_PCAPlot.html")
  exp_centroids_pcaplot = glue("{outpath}/PCA_plots/Centroids_Plots/Sample01c_major_uncond_AncestrySNPsOnly_Superpopulations_centroids.html")
  ancestry_prediction(kin, outpath, "Sample01c", "uncond", "major", "AncestrySNPsOnly", "Superpopulations (AFR/AMR/EAS/EUR/SAS Only)")
  obs_centroids = read.csv(glue("{outpath}/PCA_plots/Centroids_Plots/Sample01c_major_uncond_AncestrySNPsOnly_Superpopulations_centroids_Calculations.txt"), header=T, sep="\t")
  expect_true(file.exists(exp_pcaplot))
  expect_true(file.exists(exp_centroids_pcaplot))
  expect_equal(exp_centroids, obs_centroids)
  exp_pcaplot_all = glue("{outpath}/PCA_plots/Sample01c_major_uncond_AllSNPs_superpop_3D_PCAPlot.html")
  ancestry_prediction(kin, outpath, "Sample01c", "uncond", "major", "All Autosomal SNPs", "Superpopulations (AFR/AMR/EAS/EUR/SAS Only)")
  exp_centroids_pcaplot_all = glue("{outpath}/PCA_plots/Centroids_Plots/Sample01c_major_uncond_AllSNPs_Superpopulations_centroids.html")
  expect_true(file.exists(exp_pcaplot_all))
  expect_true(file.exists(exp_centroids_pcaplot_all))
  #outpath = "~/Desktop"
  #ancestry_prediction(kin, outpath, "Sample01c", "uncond", "major", "AncestrySNPsOnly", "Superpopulations (AFR/AMR/EAS/EUR/SAS Only)")
})
