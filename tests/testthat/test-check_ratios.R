test_that("test mixture ratios", {
  test_ss_uncond = data.frame(Set = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), C1_Prob = c(1.000, 0.998435, 1.000, 0.9983944, 0.9989943, 0.8692076, 0.8761191, 0.9995861, 1.000, 0.9998107), C2_Prob = c("1.143454e-08", "1.564764e-03", "9.328528e-09", "1.605624e-03", "1.005750e-03", "1.307924e-01", "1.238809e-01", "4.139293e-04", "1.114739e-10", "1.893304e-04"))
  expect_message(check_ratios(test_ss_uncond, uncond=TRUE), "Sample may be single source or have a very large mixture ratio. Please confirm a 2-person mixture and proceed with caution. Minor contributor inferred genotypes may be unreliable.")
  test_ss_uncond2 = data.frame(Set = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), C1_Prob = c("0.9999", "0.99999", "0.819191", "0.84141459", "0.75738", "0.735851", "0.739456", "0.742481", "0.99175338", "0.998106"), C2_Prob = c("1.11204955e-08", "4.484049e-07", "0.180806", "0.1585403", "0.2426184", "0.2641486", "0.2605435", "0.25751857", "0.0082461", "0.0018938"))
  expect_message(check_ratios(test_ss_uncond2, uncond=TRUE), "Sample may be single source or have a very large mixture ratio. Please confirm a 2-person mixture and proceed with caution. Minor contributor inferred genotypes may be unreliable.")
  test_ss_cond = data.frame(Set = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), C1_Prob = c("0.9734655", "0.9999", "0.9999", "0.99839", "0.9989", "0.9999", "0.9999", "0.9999", "0.9999", "0.9999"), C2_Prob = c("0.02653441", "7.74597497255058e-08", "4.41001968276566e-09", "0.00160468", "0.0010015", "1.8350986775717e-06", "4.69797534208283e-10", "1.26565424807268e-12", "3.07925129838793e-09", "9.72011360289571e-11"))
  expect_message(check_ratios(test_ss_cond, uncond=FALSE), "Sample may be single source or have a very large mixture ratio. Please confirm a 2-person mixture and proceed with caution. Minor contributor inferred genotypes may be unreliable.")
  test_mix_uncond = data.frame(Set = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), C1_Prob = c("0.88463954", "0.9034427", "0.8767951", "0.8868061", "0.883011", "0.884491", "0.886558", "0.8839634", "0.8941146", "0.9168024"), C2_Prob = c("0.115360", "0.096557", "0.123204", "0.11319", "0.116988", "0.115508", "0.113441", "0.1160365", "0.105885", "0.083197"))
  expect_silent(check_ratios(test_mix_uncond, uncond=TRUE))
  test_mix_cond = data.frame(Set = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), C1_Prob = c("0.848860", "0.90082", "0.88292", "0.890260", "0.883674", "0.884782", "0.895271", "0.8847507", "0.8947780", "0.913853", C2_Prob = c("0.151139", "0.099172", "0.117075", "0.1097396", "0.116325", "0.1152175", "0.1047286", "0.115249", "0.105221", "0.08614626")), C2_Prob = c("0.115360", "0.096557", "0.123204", "0.11319", "0.116988", "0.115508", "0.113441", "0.1160365", "0.105885", "0.083197"))
  expect_silent(check_ratios(test_mix_cond, uncond=FALSE))
})
